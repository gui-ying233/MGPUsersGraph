(function(){function e(e){let t={};return e.forEach(e=>{let n=[],r=``;for(let t of e.name)r+=t,r.length>=25&&(n.push(r),r=``);r&&n.push(r),t[e.id]=n}),t}function t(e,t){let n={};return e.forEach(e=>{let r=e.incomingCount+e.outgoingCount||1;n[e.id]=Math.sqrt(r)*t}),n}let n=null,r=null,i=null,a=null,o=null;function s(e,t,n,r,i){let a=e.filter(e=>!t.some(t=>t.source===e.id||t.target===e.id));if(a.length===0)return{distanceMax:1/0,centerStrength:n.centerStrength};let o=Math.sqrt(r*r+i*i)/6,s=a.length/e.length,c=n.centerStrength*(1+s*1.2);return{distanceMax:o,centerStrength:Math.min(c,3)}}function c(e,t,n,r,i){let a=(n||``).trim(),o=(r||[]).filter(e=>typeof e==`string`&&e in i),s=new Set,c=null;if(a!==``){let n=e.find(e=>e.name===a);if(n){s.add(n.id),c=n.id;let e=new Map;t.forEach(t=>{e.has(t.source)||e.set(t.source,[]),e.has(t.target)||e.set(t.target,[]),e.get(t.source).push(t),e.get(t.target).push(t)}),e.get(n.id)?.forEach(e=>{s.add(e.source===n.id?e.target:e.source)})}else return{filteredNodeIds:[],filteredLinkIds:[],searchedNodeId:null}}if(o.length>0){let e=new Set;o.forEach(t=>{(i[t]||[]).forEach(t=>{e.add(t)})}),s=a===``?e:new Set(Array.from(s).filter(t=>e.has(t)||t===c))}let l=Array.from(s),u=[];return t.forEach(e=>{s.has(e.source)&&s.has(e.target)&&u.push(`${e.source}|${e.target}`)}),{filteredNodeIds:l,filteredLinkIds:u,searchedNodeId:c}}self.onmessage=l=>{let u=l.data,{taskId:d,type:f}=u;try{if(f===`filter`){let e=u;if(e.searchTerm.trim()===``&&e.selectedTags.length===0){if(n){self.postMessage({taskId:d,result:n});return}let t=c(e.nodes,e.links,e.searchTerm,e.selectedTags,e.tagIndexCache);n=t,self.postMessage({taskId:d,result:t})}else{let t=c(e.nodes,e.links,e.searchTerm,e.selectedTags,e.tagIndexCache);self.postMessage({taskId:d,result:t})}}else if(f===`textCache`){let t=u;if(r){self.postMessage({taskId:d,result:{textLineCache:r}});return}r=e(t.nodes),self.postMessage({taskId:d,result:{textLineCache:r}})}else if(f===`nodeSize`){let e=u;if(i){self.postMessage({taskId:d,result:{nodeSizeCache:i}});return}i=t(e.nodes,e.nodeSizeMultiplier),self.postMessage({taskId:d,result:{nodeSizeCache:i}})}else if(f===`forceParams`){let e=u,t=e.filteredNodes.length;if(t===o&&a){self.postMessage({taskId:d,result:a});return}let n=s(e.filteredNodes,e.filteredLinks,e.baseConfig,e.canvasWidth,e.canvasHeight);a=n,o=t,self.postMessage({taskId:d,result:n})}}catch(e){self.postMessage({taskId:d,error:e instanceof Error?e.message:`Unknown error`})}}})();
//# sourceMappingURL=worker-KLJpdtjJ.js.map