{"version":3,"file":"filterWorker-CCcJtX1A.js","names":["searchedNodeIdResult: string | null","filteredLinkIds: string[]"],"sources":["../../src/filterWorker.ts"],"sourcesContent":["interface GraphNode {\n\tid: string;\n\tname: string;\n\ttags: string[];\n\tcolor: string;\n\tconnectionCount?: number;\n}\n\ninterface GraphLink {\n\tsource: string;\n\ttarget: string;\n}\n\ninterface FilterMessage {\n\ttype: \"filter\";\n\tnodes: GraphNode[];\n\tlinks: GraphLink[];\n\tsearchTerm: string;\n\tselectedTags: string[];\n\ttagIndexCache: Record<string, string[]>;\n}\n\ninterface FilterResult {\n\tfilteredNodeIds: string[];\n\tfilteredLinkIds: string[];\n\tsearchedNodeId: string | null;\n}\n\nself.onmessage = (event: MessageEvent<FilterMessage>) => {\n\tconst { nodes, links, searchTerm, selectedTags, tagIndexCache } =\n\t\tevent.data;\n\n\tconst sanitizedSearchTerm = (searchTerm || \"\").trim();\n\tconst sanitizedTags = (selectedTags || []).filter(\n\t\ttag => typeof tag === \"string\" && tag in tagIndexCache\n\t);\n\n\tlet resultNodeIds = new Set<string>();\n\tlet searchedNodeIdResult: string | null = null;\n\n\tif (sanitizedSearchTerm !== \"\") {\n\t\tconst matchedNode = nodes.find(\n\t\t\tnode => node.name === sanitizedSearchTerm\n\t\t);\n\n\t\tif (matchedNode) {\n\t\t\tresultNodeIds.add(matchedNode.id);\n\t\t\tsearchedNodeIdResult = matchedNode.id;\n\n\t\t\tconst linkMap = new Map<string, GraphLink[]>();\n\t\t\tlinks.forEach(link => {\n\t\t\t\tif (!linkMap.has(link.source)) linkMap.set(link.source, []);\n\t\t\t\tif (!linkMap.has(link.target)) linkMap.set(link.target, []);\n\t\t\t\tlinkMap.get(link.source)!.push(link);\n\t\t\t\tlinkMap.get(link.target)!.push(link);\n\t\t\t});\n\n\t\t\tlinkMap.get(matchedNode.id)?.forEach(link => {\n\t\t\t\tresultNodeIds.add(\n\t\t\t\t\tlink.source === matchedNode.id ? link.target : link.source\n\t\t\t\t);\n\t\t\t});\n\t\t} else {\n\t\t\tself.postMessage({\n\t\t\t\tfilteredNodeIds: [],\n\t\t\t\tfilteredLinkIds: [],\n\t\t\t\tsearchedNodeId: null,\n\t\t\t} as FilterResult);\n\t\t\treturn;\n\t\t}\n\t}\n\n\tif (sanitizedTags.length > 0) {\n\t\tconst tagFilteredNodeIds = new Set<string>();\n\t\tsanitizedTags.forEach(tag => {\n\t\t\tconst nodeIds = tagIndexCache[tag] || [];\n\t\t\tnodeIds.forEach(nodeId => {\n\t\t\t\ttagFilteredNodeIds.add(nodeId);\n\t\t\t});\n\t\t});\n\n\t\tif (sanitizedSearchTerm !== \"\") {\n\t\t\tresultNodeIds = new Set(\n\t\t\t\tArray.from(resultNodeIds).filter(\n\t\t\t\t\tid =>\n\t\t\t\t\t\ttagFilteredNodeIds.has(id) ||\n\t\t\t\t\t\tid === searchedNodeIdResult\n\t\t\t\t)\n\t\t\t);\n\t\t} else {\n\t\t\tresultNodeIds = tagFilteredNodeIds;\n\t\t}\n\t}\n\n\tconst resultNodeIdSet = resultNodeIds;\n\tconst filteredNodeIds = Array.from(resultNodeIdSet);\n\tconst filteredLinkIds: string[] = [];\n\n\tlinks.forEach(link => {\n\t\tif (\n\t\t\tresultNodeIdSet.has(link.source) &&\n\t\t\tresultNodeIdSet.has(link.target)\n\t\t) {\n\t\t\tfilteredLinkIds.push(`${link.source}|${link.target}`);\n\t\t}\n\t});\n\n\tself.postMessage({\n\t\tfilteredNodeIds,\n\t\tfilteredLinkIds,\n\t\tsearchedNodeId: searchedNodeIdResult,\n\t} as FilterResult);\n};\n"],"mappings":"YA4BA,KAAK,UAAa,GAAuC,CACxD,GAAM,CAAE,QAAO,QAAO,aAAY,eAAc,iBAC/C,EAAM,KAED,GAAuB,GAAc,IAAI,MAAM,CAC/C,GAAiB,GAAgB,EAAE,EAAE,OAC1C,GAAO,OAAO,GAAQ,UAAY,KAAO,EACzC,CAEG,EAAgB,IAAI,IACpBA,EAAsC,KAE1C,GAAI,IAAwB,GAAI,CAC/B,IAAM,EAAc,EAAM,KACzB,GAAQ,EAAK,OAAS,EACtB,CAED,GAAI,EAAa,CAChB,EAAc,IAAI,EAAY,GAAG,CACjC,EAAuB,EAAY,GAEnC,IAAM,EAAU,IAAI,IACpB,EAAM,QAAQ,GAAQ,CAChB,EAAQ,IAAI,EAAK,OAAO,EAAE,EAAQ,IAAI,EAAK,OAAQ,EAAE,CAAC,CACtD,EAAQ,IAAI,EAAK,OAAO,EAAE,EAAQ,IAAI,EAAK,OAAQ,EAAE,CAAC,CAC3D,EAAQ,IAAI,EAAK,OAAO,CAAE,KAAK,EAAK,CACpC,EAAQ,IAAI,EAAK,OAAO,CAAE,KAAK,EAAK,EACnC,CAEF,EAAQ,IAAI,EAAY,GAAG,EAAE,QAAQ,GAAQ,CAC5C,EAAc,IACb,EAAK,SAAW,EAAY,GAAK,EAAK,OAAS,EAAK,OACpD,EACA,KACI,CACN,KAAK,YAAY,CAChB,gBAAiB,EAAE,CACnB,gBAAiB,EAAE,CACnB,eAAgB,KAChB,CAAiB,CAClB,QAIF,GAAI,EAAc,OAAS,EAAG,CAC7B,IAAM,EAAqB,IAAI,IAC/B,EAAc,QAAQ,GAAO,EACZ,EAAc,IAAQ,EAAE,EAChC,QAAQ,GAAU,CACzB,EAAmB,IAAI,EAAO,EAC7B,EACD,CAEF,AACC,EADG,IAAwB,GASX,EARA,IAAI,IACnB,MAAM,KAAK,EAAc,CAAC,OACzB,GACC,EAAmB,IAAI,EAAG,EAC1B,IAAO,EACR,CACD,CAMH,IAAM,EAAkB,EAClB,EAAkB,MAAM,KAAK,EAAgB,CAC7CC,EAA4B,EAAE,CAEpC,EAAM,QAAQ,GAAQ,CAEpB,EAAgB,IAAI,EAAK,OAAO,EAChC,EAAgB,IAAI,EAAK,OAAO,EAEhC,EAAgB,KAAK,GAAG,EAAK,OAAO,GAAG,EAAK,SAAS,EAErD,CAEF,KAAK,YAAY,CAChB,kBACA,kBACA,eAAgB,EAChB,CAAiB"}